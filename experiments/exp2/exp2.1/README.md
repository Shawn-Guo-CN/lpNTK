# Exp 2.1: Various Kernels on MNIST

This experiment aims to try various kernels on MNIST. In `exp1.1`, the gradient matrices are calculated on MNIST, and stored in `data/{dataset}/GradMatrix/*.npy`.
So, in this experiment, we can easily try various kernels by loading and re-using those gradient matrices.

The kernels are calculated in the following ways:

1. Sum: the sum of the gradient matrices, i.e., $K = \sum_{jk} G_{jk}$, this corresponds to pNTK.
2. Masked Sum (MaskSum): change the sign with labels then sum the gradient matrices. For example, if the labels are $y_i$ and $y_j$, then the kernel is $K = \sum_{ij} G_{ij} \cdot y_i \cdot y_j$.

## Inputs

1. GradMatrix files generated by Exp 0.2: `data/{dataset}/GradMatrix/*.npy`

## Outputs

1. Kernel files: `data/{dataset}/{kernel_name}Kernel/*.npy`